AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: 'Backend API for the Band Scheduler App

  '
Globals:
  Function:
    Timeout: 10
Resources:
  BandSchedulerFunction:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: BandSchedulerFunction
      Handler: dist/lambda.Handler
      Runtime: nodejs18.x
      Policies:
      - DynamoDBCrudPolicy: null
        TableName: bands
      - DynamoDBCrudPolicy: null
        TableName: members
      Environment:
        Variables:
          AWS_REGION:
            Ref: AWS::AWS_REGION
    Metadata:
      SamResourceId: BandSchedulerFunction
  ApiGateway:
    Type: AWS::Serverless::HttpApi
    Properties:
      CorsConfiguration:
        AllowOrigins:
        - http://localhost:5173
        AllowHeaders:
        - Content-Type
        AllowMethods:
        - GET
        - POST
        - PUT
        - DELETE
        - OPTIONS
        AllowCredentials: true
Outputs:
  ApiUrl:
    Description: API Gateway endpoint URL
    Value:
      Fn::Sub: https://://${ServerlessHttpApi}.execute-api.${AWS::Region}.amazonaws.com
